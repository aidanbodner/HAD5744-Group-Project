---
title: "Final Project Analysis"
author: "Husayn Jessa, Sarah Kipping, Mathew Tracey, Aidan Bodner"
date: "14/10/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Load Packages}
library(tidyverse) # load the installed package for each new session of R
library(broom) # helps for storing regression output
library(here) # for file organization
library(gtsummary) # For creating summary statistics table
library(gt) # For outputting gt objects

```

```{r Data Cleaning}
here() # Set working directory
raw_data <- read.csv("/Users/aidanbodner/Documents/GitHub/HAD5744-Group-Project/1. Data/data.csv", 
                     na.strings = c(" ", "", "NA", "9999: Missing")) # Load original data

analysis_data <- raw_data[, c("gad_anxious", "gad_worry", "phq_little_interest", 
                              "phq_feeling_down", "occupation","employment_impact_not_employed", 
                              "money_concerned","employment_impact_laid_off", 
                              "work_from_home", "age_groups", "gender", 
                              "identity_lgbtq", "identity_bipoc",
                              "educational_attainment", "income", 
                              "own_rent")]

# Scan through analysis dataframe to see variable class types
for(values in names(analysis_data)){
  print(names(analysis_data[values]))
  name <- names(analysis_data[values])
  print(class(analysis_data[,values]))
} # all variables are characters

# Remove people who were not working before the COVID-19 pandemic
analysis_data <- analysis_data[!analysis_data$employment_impact_not_employed == "I was not employed or self-employed before the COVID-19", ]

##### Clean Labels ####
# Laid off during COVID
analysis_data$employment_impact_laid_off[analysis_data$employment_impact_laid_off == "8888: Not Selected"] <- "No"
analysis_data$employment_impact_laid_off[analysis_data$employment_impact_laid_off == "I was laid off temporarily or permanently"] <- "Yes"


# Sexual minority
analysis_data$identity_lgbtq[analysis_data$identity_lgbtq == "8888: Not Selected"] <- "No"
analysis_data$identity_lgbtq[analysis_data$identity_lgbtq == "Sexual or gender minorities (e.g., LGBTQ2+)"] <- "Yes"

# People of Colour
analysis_data$identity_bipoc[analysis_data$identity_bipoc == "8888: Not Selected"] <- "No"
analysis_data$identity_bipoc[analysis_data$identity_bipoc == "People of colour (e.g., Black, Indigenous, Asian  or other racialized minority)"] <- "Yes"

# Convert to factor
analysis_data[, 1:16] <- lapply(analysis_data[, 1:16], as.factor)

### Reorder levels of certain variables ###




```


```{r Summary Statistics}
table_data <- analysis_data[, c("gad_anxious", "gad_worry", "phq_little_interest", 
                              "phq_feeling_down", "occupation","employment_impact_not_employed", 
                              "money_concerned","employment_impact_laid_off", 
                              "work_from_home", "age_groups", "gender", 
                              "identity_lgbtq", "identity_bipoc",
                              "educational_attainment", "income", 
                              "own_rent")]

summary_table <- tbl_summary(analysis_data, include = c("gad_anxious", "gad_worry", "phq_little_interest", 
                                                        "phq_feeling_down", "occupation",
                                                        "money_concerned", "employment_impact_laid_off", "age_groups", 
                                                        "gender", "identity_lgbtq", "identity_bipoc",
                                                        "educational_attainment", "income", "own_rent"),
                             by = employment_impact_laid_off,
                             label = list(gad_anxious ~ "Over the past two weeks, how often have you felt nervous, anxious or on edge?",
                                          gad_worry ~ "Over the past two weeks, how often were you not able to stop worrying or control your worries?",
                                          phq_little_interest ~ "Over the past two weeks, how often have you had little interest or pleasure in doing things?",
                                          phq_feeling_down ~ "Over the PAST TWO WEEKS, how often were you feeling down, depressed or hopeless? ",
                                          occupation ~ "Occupation",
                                          money_concerned ~ "Concerned that the money I have or will save wont last",
                                          employment_impact_laid_off ~ "Laid off temporarily or permanently", 
                                          age_groups ~ "Age", 
                                          gender ~ "Gender", 
                                          identity_lgbtq ~ "Sexual or gender minority (e.g., LGBTQ2+)",
                                          identity_bipoc ~ "Person of colour (e.g., Black, Indigenous, Asian  or other racialized minority)",
                                          educational_attainment ~ "Educational Attainment",
                                          income ~ "Income",
                                          own_rent ~ "Dwelling Ownership"), 
                             missing = "no", 
                             type = list(employment_impact_laid_off ~ "categorical", 
                                         identity_lgbtq ~ "categorical",
                                         identity_bipoc ~ "categorical")) %>% 
  as_gt %>%
  gt::gtsave(filename = "//Users//aidanbodner//Desktop//Summary.docx")


```

