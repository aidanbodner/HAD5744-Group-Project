"educational_attainment", "income",
"own_rent")]
# Scan through analysis dataframe to see variable class types
for(values in names(analysis_data)){
print(names(analysis_data[values]))
name <- names(analysis_data[values])
print(class(analysis_data[,values]))
} # all variables are characters
# Remove people who were not working before the COVID-19 pandemic
analysis_data <- analysis_data[analysis_data$employment_impact_not_employed != "I was not employed or self-employed before the COVID-19", ]
# Remove people over 70
analysis_data <- analysis_data[analysis_data$age_groups != "70 to 74 years", ]
analysis_data <- analysis_data[analysis_data$age_groups != "75 to 79 years", ]
analysis_data <- analysis_data[analysis_data$age_groups != "80 to 84 years", ]
# Remove people who responded other to dwelling ownership
analysis_data <- analysis_data[analysis_data$own_rent != "Other", ]
##### Clean Labels ####
# GAD -- Over the past two weeks, how often have you felt nervous, anxious or on edge?
analysis_data$gad_anxious[analysis_data$gad_anxious == "Not at all"] <- 0
analysis_data$gad_anxious[analysis_data$gad_anxious == "Several days"] <- 1
analysis_data$gad_anxious[analysis_data$gad_anxious == "More than half the days"] <- 2
analysis_data$gad_anxious[analysis_data$gad_anxious == "Nearly every day"] <- 3
analysis_data$gad_anxious <- as.numeric(analysis_data$gad_anxious)
# GAD -- Over the past two weeks, how often were you not able to stop worrying or control your worries?
analysis_data$gad_worry[analysis_data$gad_worry == "Not at all"] <- 0
analysis_data$gad_worry[analysis_data$gad_worry == "Several days"] <- 1
analysis_data$gad_worry[analysis_data$gad_worry == "More than half the days"] <- 2
analysis_data$gad_worry[analysis_data$gad_worry == "Nearly every day"] <- 3
analysis_data$gad_worry <- as.numeric(analysis_data$gad_worry)
# Create new combined GAD score
analysis_data$gad_total <- analysis_data$gad_anxious + analysis_data$gad_worry
# PHQ -- Over the past two weeks, how often have you had little interest or pleasure in doing things?
analysis_data$phq_feeling_down[analysis_data$phq_feeling_down == "Not at all"] <- 0
analysis_data$phq_feeling_down[analysis_data$phq_feeling_down == "Several days"] <- 1
analysis_data$phq_feeling_down[analysis_data$phq_feeling_down == "More than half the days"] <- 2
analysis_data$phq_feeling_down[analysis_data$phq_feeling_down == "Nearly every day"] <- 3
analysis_data$phq_feeling_down <- as.numeric(analysis_data$phq_feeling_down)
# PHQ -- Over the PAST TWO WEEKS, how often were you feeling down, depressed or hopeless?
analysis_data$phq_little_interest[analysis_data$phq_little_interest == "Not at all"] <- 0
analysis_data$phq_little_interest[analysis_data$phq_little_interest == "Several days"] <- 1
analysis_data$phq_little_interest[analysis_data$phq_little_interest == "More than half the days"] <- 2
analysis_data$phq_little_interest[analysis_data$phq_little_interest == "Nearly every day"] <- 3
analysis_data$phq_little_interest <- as.numeric(analysis_data$phq_little_interest)
# Create new combined PHQ score
analysis_data$phq_total <- analysis_data$phq_feeling_down + analysis_data$phq_little_interest
# Occupation
analysis_data$occupation[analysis_data$occupation == "Business, finance and administration occupations"] <- "Business & Management"
analysis_data$occupation[analysis_data$occupation == "Management occupations"] <- "Business & Management"
analysis_data$occupation[analysis_data$occupation == "Natural resources, agriculture and related production occupations" ] <- "Trades"
analysis_data$occupation[analysis_data$occupation ==
"Occupations in manufacturing and utilities"] <- "Trades"
analysis_data$occupation[analysis_data$occupation == "Trades, transport and equipment operators and related occupations" ] <- "Trades"
analysis_data$occupation[analysis_data$occupation == "Health occupations" ] <- "Health & Sciences"
analysis_data$occupation[analysis_data$occupation ==
"Natural and applied sciences and related occupationss"] <- "Health & Sciences"
# How well do each of the statements describe you? - I am just getting by financially.
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Completely"] <- "Yes"
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Very Well"] <- "Yes"
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Somewhat"] <- "Yes"
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Not at all"] <- "No"
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Very Little"] <- "No"
# Age
analysis_data$age_groups[analysis_data$age_groups == "16 to 19 years"
] <- "16 to 24 years"
analysis_data$age_groups[analysis_data$age_groups ==
"20 to 24 years"] <- "16 to 24 years"
analysis_data$age_groups[analysis_data$age_groups == "25 to 29 years" ] <- "25 to 39 years"
analysis_data$age_groups[analysis_data$age_groups == "30 to 34 years"] <- "25 to 39 years"
analysis_data$age_groups[analysis_data$age_groups ==
"35 to 39 years"] <- "25 to 39 years"
analysis_data$age_groups[analysis_data$age_groups == "40 to 44 years" ] <- "40 to 54 years"
analysis_data$age_groups[analysis_data$age_groups ==
"45 to 49 years"] <- "40 to 54 years"
analysis_data$age_groups[analysis_data$age_groups ==
"50 to 54 years"] <- "40 to 54 years"
analysis_data$age_groups[analysis_data$age_groups == "55 to 59 years" ] <- "55 to 69 years"
analysis_data$age_groups[analysis_data$age_groups ==
"60 to 64 years"
] <- "55 to 69 years"
analysis_data$age_groups[analysis_data$age_groups ==
"65 to 69 years"] <- "55 to 69 years"
# Educational attainment -- TO BE COMPLETED
# Income
analysis_data$income[analysis_data$income == "Under $5,000" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$5,000 to $9,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$10,000 to $14,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$15,000 to $19,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$20,000 to $24,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$25,000 to $29,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$30,000 to $34,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$35,000 to $39,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$40,000 to $44,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$45,000 to $49,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$50,000 to $59,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$60,000 to $69,999" ] <- "Middle-Income"
analysis_data$income[analysis_data$income == "$70,000 to $79,999" ] <- "Middle-Income"
analysis_data$income[analysis_data$income == "$80,000 to $89,999" ] <- "Middle-Income"
analysis_data$income[analysis_data$income == "$90,000 to $99,999" ] <- "Middle-Income"
analysis_data$income[analysis_data$income == "$100,000 to $149,999" ] <- "High-Income"
analysis_data$income[analysis_data$income == "$150,000 to $199,999" ] <- "High-Income"
analysis_data$income[analysis_data$income == "$200,000 or more" ] <- "High-Income"
# Dwelling Ownership
analysis_data <- mutate_at(.tbl = analysis_data,
.vars = vars(own_rent),
.funs = ~case_when(. == "Own it with mortgage or loan (including condos)" ~ "Cost Incurred from Housing",
. == "Rent it without subsidies, i.e. you pay a market rate" ~ "Cost Incurred from Housing",
. == "Part own and part rent (shared ownership such as co-op)" ~ "Cost Incurred from Housing, Subsidized",
. == "Rent it with subsidies, i.e. you pay a below-market rate (including rent geared to income, social housing, government assisted housing, housing allowances, etc.)" ~ "Cost Incurred from Housing, Subsidized",
. == "Own it outright (including condos)" ~ "No Cost Incurred from Housing",
. == "Rent at no costs, i.e. rent-free in relative\x92s/friend\x92s property\\" ~ "No Cost Incurred from Housing",
TRUE ~ .,
TRUE ~ as.character(NA_character_)))
# Laid off during COVID
analysis_data$employment_impact_laid_off[analysis_data$employment_impact_laid_off == "8888: Not Selected"] <- "No"
analysis_data$employment_impact_laid_off[analysis_data$employment_impact_laid_off == "I was laid off temporarily or permanently"] <- "Yes"
# Sexual minority
analysis_data$identity_lgbtq[analysis_data$identity_lgbtq == "8888: Not Selected"] <- "No"
analysis_data$identity_lgbtq[analysis_data$identity_lgbtq == "Sexual or gender minorities (e.g., LGBTQ2+)"] <- "Yes"
# People of Colour
analysis_data$identity_bipoc[analysis_data$identity_bipoc == "8888: Not Selected"] <- "No"
analysis_data$identity_bipoc[analysis_data$identity_bipoc == "People of colour (e.g., Black, Indigenous, Asian  or other racialized minority)"] <- "Yes"
analysis_data <- analysis_data[, c("gad_total", "phq_total", "occupation","employment_impact_laid_off", "age_groups", "gender", "identity_lgbtq", "identity_bipoc","income", "own_rent", "money_fetting_by")]
# Number of missing
#analysis_data <- na.omit(analysis_data)
aggplot <- aggr(analysis_data, cex.axis = .385)
?aggr
fig1 <- ggplot(analysis_data, aes(gad_total,group=money_fetting_by,fill=money_fetting_by)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic() +
labs(x = "GAD Total Score", fill = "Financial Secrutiy")
fig2 <- ggplot(analysis_data, aes(phq_total,group=money_fetting_by,fill=money_fetting_by)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic() + theme(legend.position = "none") +
labs(x = "PHQ Total Score") + geom_vline(xintercept = median(phq_total))
analysis_data <- read.csv("/Users/aidanbodner/Documents/GitHub/HAD5744-Group-Project/1. Data/imputed_data.csv")
fig1 <- ggplot(analysis_data, aes(gad_total,group=money_fetting_by,fill=money_fetting_by)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic() +
labs(x = "GAD Total Score", fill = "Financial Secrutiy")
fig2 <- ggplot(analysis_data, aes(phq_total,group=money_fetting_by,fill=money_fetting_by)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic() + theme(legend.position = "none") +
labs(x = "PHQ Total Score") + geom_vline(xintercept = median(phq_total))
View(analysis_data)
fig1
fig2 <- ggplot(analysis_data, aes(phq_total,group=money_fetting_by,fill=money_fetting_by)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic() + theme(legend.position = "none") +
labs(x = "PHQ Total Score") + geom_vline(xintercept = median(phq_total))
fig1 <- ggplot(analysis_data, aes(phq_total,group=money_fetting_by,fill=money_fetting_by)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic() +
labs(x = "GAD Total Score", fill = "Financial Secrutiy")
fig2 <- ggplot(analysis_data, aes(phq_total,group=money_fetting_by,fill=money_fetting_by)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic() + theme(legend.position = "none") +
labs(x = "PHQ Total Score") + geom_vline(xintercept = median(phq_total))
fig2 <- ggplot(analysis_data, aes(phq_total, group=money_fetting_by,fill=money_fetting_by)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic() +
labs(x = "GAD Total Score", fill = "Financial Secrutiy")
fig1 <- ggplot(analysis_data, aes(gad_total,group=money_fetting_by,fill=money_fetting_by)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic() +
labs(x = "GAD-2 Total Score", fill = "Financial Security")
fig2 <- ggplot(analysis_data, aes(phq_total, group=money_fetting_by,fill=money_fetting_by)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic() +
labs(x = "PHQ-2 Total Score", fill = "Financial Security")
legend1 <- get_legend(fig1 + guides(color=guide_legend(nrow = 1)) +
theme(legend.position = "bottom",legend.box = "horizontal"))
?get_legend()
install.packages("cowplot")
library(cowplot)
legend1 <- get_legend(fig1 + guides(color=guide_legend(nrow = 1)) +
theme(legend.position = "bottom",legend.box = "horizontal"))
fig1
fig2
fig1
fig2
?ggsave
ggsave(fig1, path = "//Users//aidanbodner//Desktop//regression_table.png", dpi = 300)
fig1 <- ggplot(analysis_data, aes(gad_total,group=money_fetting_by,fill=money_fetting_by)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic() +
labs(x = "GAD-2 Total Score", fill = "Financial Security")
ggsave(fig1, path = "//Users//aidanbodner//Desktop//regression_table.png", dpi = 300)
ggsave(plot = fig1, filename  = "//Users//aidanbodner//Desktop//regression_table.png", dpi = 300)
ggsave(plot = fig2, filename  = "//Users//aidanbodner//Desktop//regression_table.png", dpi = 300)
ggsave(plot = fig1, filename  = "//Users//aidanbodner//Desktop//GAD-2.png", dpi = 300)
ggsave(plot = fig2, filename  = "//Users//aidanbodner//Desktop//PHQ-2.png", dpi = 300)
ggsave(plot = fig1, filename  = "//Users//aidanbodner//Desktop//GAD-2.png", dpi = 350)
ggsave(plot = fig1, filename  = "//Users//aidanbodner//Desktop//GAD-2.png", dpi = 700)
knitr::opts_chunk$set(echo = TRUE)
analysis_data <- read.csv("/Users/aidanbodner/Documents/GitHub/HAD5744-Group-Project/1. Data/imputed_data.csv")
summary_table <- tbl_summary(analysis_data, include = c("gad_total", "phq_total", "occupation",
"money_fetting_by", "age_groups", "employment_impact_laid_off",
"gender", "identity_lgbtq", "identity_bipoc", "income", "own_rent"),
by = employment_impact_laid_off,
label = list(gad_total ~ "GAD Score",
money_fetting_by ~ "I am just getting by financially",
phq_total ~ "PHQ Score",
occupation ~ "Occupation",
money_fetting_by ~ "Concerned that the money I have or will save wont last",
age_groups ~ "Age",
gender ~ "Gender",
identity_lgbtq ~ "Sexual or gender minority (e.g., LGBTQ2+)",
identity_bipoc ~ "Person of colour (e.g., Black, Indigenous, Asian  or other racialized minority)",
income ~ "Income",
own_rent ~ "Dwelling Ownership"),
missing = "no",
type = list(identity_lgbtq ~ "categorical",
identity_bipoc ~ "categorical",
occupation ~ "categorical",
age_groups ~ "categorical",
income ~ "categorical",
own_rent ~ "categorical",
gender ~ "categorical")) %>%
as_gt %>%
gt::gtsave(filename = "//Users//aidanbodner//Desktop//Summary.docx")
library(tidyverse) # load the installed package for each new session of R
library(broom) # helps for storing regression output
library(here) # for file organization
library(gtsummary) # For creating summary statistics table
library(gt) # For outputting gt objects
library(MatchIt) # For matching
library(mice) # For imputation
library(modelsummary) # For regression tables
library(VIM) # To visualize missing data
library(cowplot) # To create legend for histogram
summary_table <- tbl_summary(analysis_data, include = c("gad_total", "phq_total", "occupation",
"money_fetting_by", "age_groups", "employment_impact_laid_off",
"gender", "identity_lgbtq", "identity_bipoc", "income", "own_rent"),
by = employment_impact_laid_off,
label = list(gad_total ~ "GAD Score",
money_fetting_by ~ "I am just getting by financially",
phq_total ~ "PHQ Score",
occupation ~ "Occupation",
money_fetting_by ~ "Concerned that the money I have or will save wont last",
age_groups ~ "Age",
gender ~ "Gender",
identity_lgbtq ~ "Sexual or gender minority (e.g., LGBTQ2+)",
identity_bipoc ~ "Person of colour (e.g., Black, Indigenous, Asian  or other racialized minority)",
income ~ "Income",
own_rent ~ "Dwelling Ownership"),
missing = "no",
type = list(identity_lgbtq ~ "categorical",
identity_bipoc ~ "categorical",
occupation ~ "categorical",
age_groups ~ "categorical",
income ~ "categorical",
own_rent ~ "categorical",
gender ~ "categorical")) %>%
as_gt %>%
gt::gtsave(filename = "//Users//aidanbodner//Desktop//Summary.docx")
?tbl_summary
summary_table_1 <- tbl_summary(analysis_data, include = c("gad_total", "phq_total", "occupation",
"money_fetting_by", "age_groups", "employment_impact_laid_off",
"gender", "identity_lgbtq", "identity_bipoc", "income", "own_rent"),
label = list(gad_total ~ "GAD Score",
money_fetting_by ~ "I am just getting by financially",
employment_impact_laid_off ~ "Laid off temporarily or permanently during COVID-19 Pandemic",
phq_total ~ "PHQ Score",
occupation ~ "Occupation",
money_fetting_by ~ "Concerned that the money I have or will save wont last",
age_groups ~ "Age",
gender ~ "Gender",
identity_lgbtq ~ "Sexual or gender minority (e.g., LGBTQ2+)",
identity_bipoc ~ "Person of colour (e.g., Black, Indigenous, Asian  or other racialized minority)",
income ~ "Income",
own_rent ~ "Dwelling Ownership"),
missing = "no",
type = list(identity_lgbtq ~ "categorical",
identity_bipoc ~ "categorical",
occupation ~ "categorical",
age_groups ~ "categorical",
income ~ "categorical",
own_rent ~ "categorical",
gender ~ "categorical"))
summary_table_2 <- tbl_summary(analysis_data, include = c("gad_total", "phq_total", "occupation",
"money_fetting_by", "age_groups", "employment_impact_laid_off",
"gender", "identity_lgbtq", "identity_bipoc", "income", "own_rent"),
by = employment_impact_laid_off,
label = list(gad_total ~ "GAD Score",
money_fetting_by ~ "I am just getting by financially",
phq_total ~ "PHQ Score",
occupation ~ "Occupation",
money_fetting_by ~ "Concerned that the money I have or will save wont last",
age_groups ~ "Age",
gender ~ "Gender",
identity_lgbtq ~ "Sexual or gender minority (e.g., LGBTQ2+)",
identity_bipoc ~ "Person of colour (e.g., Black, Indigenous, Asian  or other racialized minority)",
income ~ "Income",
own_rent ~ "Dwelling Ownership"),
missing = "no",
type = list(identity_lgbtq ~ "categorical",
identity_bipoc ~ "categorical",
occupation ~ "categorical",
age_groups ~ "categorical",
income ~ "categorical",
own_rent ~ "categorical",
gender ~ "categorical")) #%>%
#as_gt %>%
#gt::gtsave(filename = "//Users//aidanbodner//Desktop//Summary.docx")
summary_table <- tbl_merge(tbls = list(summary_table_1,
summary_table_2)) %>%
as_gt %>%
gt::gtsave(file = "//Users//aidanbodner//Desktop//summary_table.rtf")
summary_table <- tbl_merge(tbls = list(summary_table_1,
summary_table_2)) %>%
as_gt %>%
gt::gtsave(file = "//Users//aidanbodner//Desktop//summary_table.docx")
# Missing data
aggplot <- aggr(analysis_data, cex.axis = .385)
# Outcome histograms
fig1 <- ggplot(analysis_data, aes(gad_total,group=employment_impact_laid_off,fill=employment_impact_laid_off)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic() +
labs(x = "GAD-2 Total Score", fill = "Financial Security")
fig2 <- ggplot(analysis_data, aes(phq_total, group=employment_impact_laid_off,fill=employment_impact_laid_off)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic() +
labs(x = "PHQ-2 Total Score", fill = "Financial Security")
ggsave(plot = fig1, filename  = "//Users//aidanbodner//Desktop//GAD-2.png", dpi = 700)
ggsave(plot = fig2, filename  = "//Users//aidanbodner//Desktop//PHQ-2.png", dpi = 700)
# Outcome histograms
fig1 <- ggplot(analysis_data, aes(gad_total,group=employment_impact_laid_off,fill=employment_impact_laid_off)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic() +
labs(x = "GAD-2 Total Score", fill = "Laid Off")
fig2 <- ggplot(analysis_data, aes(phq_total, group=employment_impact_laid_off,fill=employment_impact_laid_off)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic() +
labs(x = "PHQ-2 Total Score", fill = "Laid Off")
ggsave(plot = fig1, filename  = "//Users//aidanbodner//Desktop//GAD-2.png", dpi = 700)
ggsave(plot = fig2, filename  = "//Users//aidanbodner//Desktop//PHQ-2.png", dpi = 700)
analysis_match <- matchit(employment_impact_laid_off ~ occupation + age_groups + gender + identity_lgbtq +
identity_bipoc + income + own_rent,
data = analysis_data,
method = "exact")
summary(analysis_match)
analysis_match_data <-  match.data(analysis_match)
analysis_match_data$gad_clinical_cut <- ifelse(analysis_match_data$gad_total >= 3,1,0) #creating a binary variable based on the clinical cut off of GAD-2
analysis_match_data$phq_clinical_cut <- ifelse(analysis_match_data$phq_total >= 3,1,0)
table(analysis_match_data$employment_impact_laid_off, analysis_match_data$gad_clinical_cut)
gad_chi <- chisq.test(analysis_match_data$employment_impact_laid_off, analysis_match_data$gad_clinical_cut)
table(analysis_match_data$employment_impact_laid_off, analysis_match_data$phq_clinical_cut)
phq_chi <- chisq.test(analysis_match_data$employment_impact_laid_off, analysis_match_data$phq_clinical_cut)
prop.table(table(analysis_match_data$employment_impact_laid_off, analysis_match_data$gad_clinical_cut))*100
table(analysis_match_data$employment_impact_laid_off, analysis_match_data$gad_clinical_cut)
gad_chi <- chisq.test(analysis_match_data$employment_impact_laid_off, analysis_match_data$gad_clinical_cut)
table(analysis_match_data$employment_impact_laid_off, analysis_match_data$phq_clinical_cut)
phq_chi <- chisq.test(analysis_match_data$employment_impact_laid_off, analysis_match_data$phq_clinical_cut)
table(analysis_match_data$employment_impact_laid_off, analysis_match_data$gad_clinical_cut)
gad_chi <- chisq.test(analysis_match_data$employment_impact_laid_off, analysis_match_data$gad_clinical_cut)
table(analysis_match_data$employment_impact_laid_off, analysis_match_data$phq_clinical_cut)
phq_chi <- chisq.test(analysis_match_data$employment_impact_laid_off, analysis_match_data$phq_clinical_cut)
gad_chi
phq_chi
prop.table(table(analysis_match_data$employment_impact_laid_off, analysis_match_data$gad_clinical_cut))*100
?prop.table
prop.table(table(analysis_match_data$employment_impact_laid_off, analysis_match_data$gad_clinical_cut), 1)*100
prop.table(table(analysis_match_data$employment_impact_laid_off, analysis_match_data$phq_clinical_cut), 1)*100
?mantelhaen.test
table(analysis_match_data$money_fetting_by, analysis_match_data$gad_clinical_cut, analysis_data$employment_impact_laid_off)
length(analysis_data$employment_impact_laid_off)
length(analysis_match_data$gad_clinical_cut)
length(analysis_match_data$money_fetting_by)
table(analysis_match_data$money_fetting_by, analysis_match_data$gad_clinical_cut, analysis_match_data$employment_impact_laid_off)
?table()
table(analysis_match_data$money_fetting_by, analysis_match_data$gad_clinical_cut, analysis_match_data$employment_impact_laid_off == "Yes")
gad_table <- table(analysis_match_data$money_fetting_by, analysis_match_data$gad_clinical_cut, analysis_match_data$employment_impact_laid_off)
prop.table(gad_table, 1)*100
gad_mantel <- mantelhaen.test(gad_table)
gad_mantel
gad_table
gad_table
prop.table(gad_table, 1)*100
prop.table(gad_table)*100
prop.table(gad_table, 2)*100
prop.table(gad_table, 1)*100
?prop.table
prop.table(gad_table, 3)*100
prop.table(gad_table, 1)*100
gad_mantel <- mantelhaen.test(gad_table)
gad_mantel
phq_table <- table(analysis_match_data$money_fetting_by, analysis_match_data$phq_clinical_cut, analysis_match_data$employment_impact_laid_off)
phq_table
prop.table(phq_table, 1)*100
phq_mantel <- mantelhaen.test(phq_table)
phq_mantel
?mantelhaen.test
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse) # load the installed package for each new session of R
library(broom) # helps for storing regression output
library(here) # for file organization
library(gtsummary) # For creating summary statistics table
library(gt) # For outputting gt objects
library(MatchIt) # For matching
library(mice) # For imputation
library(modelsummary) # For regression tables
library(VIM) # To visualize missing data
library(cowplot) # To create legend for histogram
summary_table_1 <- tbl_summary(analysis_data, include = c("gad_total", "phq_total", "occupation",
"money_fetting_by", "age_groups", "employment_impact_laid_off",
"gender", "identity_lgbtq", "identity_bipoc", "income", "own_rent"),
label = list(gad_total ~ "GAD Score",
money_fetting_by ~ "I am just getting by financially",
employment_impact_laid_off ~ "Laid off temporarily or permanently during COVID-19 Pandemic",
phq_total ~ "PHQ Score",
occupation ~ "Occupation",
age_groups ~ "Age",
gender ~ "Gender",
identity_lgbtq ~ "Sexual or gender minority (e.g., LGBTQ2+)",
identity_bipoc ~ "Person of colour (e.g., Black, Indigenous, Asian  or other racialized minority)",
income ~ "Income",
own_rent ~ "Dwelling Ownership"),
missing = "no",
type = list(identity_lgbtq ~ "categorical",
identity_bipoc ~ "categorical",
occupation ~ "categorical",
age_groups ~ "categorical",
income ~ "categorical",
own_rent ~ "categorical",
gender ~ "categorical"))
analysis_data <- read.csv("/Users/aidanbodner/Documents/GitHub/HAD5744-Group-Project/1. Data/imputed_data.csv")
summary_table_1 <- tbl_summary(analysis_data, include = c("gad_total", "phq_total", "occupation",
"money_fetting_by", "age_groups", "employment_impact_laid_off",
"gender", "identity_lgbtq", "identity_bipoc", "income", "own_rent"),
label = list(gad_total ~ "GAD Score",
money_fetting_by ~ "I am just getting by financially",
employment_impact_laid_off ~ "Laid off temporarily or permanently during COVID-19 Pandemic",
phq_total ~ "PHQ Score",
occupation ~ "Occupation",
age_groups ~ "Age",
gender ~ "Gender",
identity_lgbtq ~ "Sexual or gender minority (e.g., LGBTQ2+)",
identity_bipoc ~ "Person of colour (e.g., Black, Indigenous, Asian  or other racialized minority)",
income ~ "Income",
own_rent ~ "Dwelling Ownership"),
missing = "no",
type = list(identity_lgbtq ~ "categorical",
identity_bipoc ~ "categorical",
occupation ~ "categorical",
age_groups ~ "categorical",
income ~ "categorical",
own_rent ~ "categorical",
gender ~ "categorical"))
summary_table_2 <- tbl_summary(analysis_data, include = c("gad_total", "phq_total", "occupation",
"money_fetting_by", "age_groups", "employment_impact_laid_off",
"gender", "identity_lgbtq", "identity_bipoc", "income", "own_rent"),
by = employment_impact_laid_off,
label = list(gad_total ~ "GAD Score",
money_fetting_by ~ "I am just getting by financially",
phq_total ~ "PHQ Score",
occupation ~ "Occupation",
money_fetting_by ~ "Concerned that the money I have or will save wont last",
age_groups ~ "Age",
gender ~ "Gender",
identity_lgbtq ~ "Sexual or gender minority (e.g., LGBTQ2+)",
identity_bipoc ~ "Person of colour (e.g., Black, Indigenous, Asian  or other racialized minority)",
income ~ "Income",
own_rent ~ "Dwelling Ownership"),
missing = "no",
type = list(identity_lgbtq ~ "categorical",
identity_bipoc ~ "categorical",
occupation ~ "categorical",
age_groups ~ "categorical",
income ~ "categorical",
own_rent ~ "categorical",
gender ~ "categorical")) #%>%
#as_gt %>%
#gt::gtsave(filename = "//Users//aidanbodner//Desktop//Summary.docx")
summary_table <- tbl_merge(tbls = list(summary_table_1,
summary_table_2)) %>%
as_gt %>%
gt::gtsave(file = "//Users//aidanbodner//Desktop//summary_table.docx")
summary_table_1 <- tbl_summary(analysis_data, include = c("gad_total", "phq_total", "occupation",
"money_fetting_by", "age_groups", "employment_impact_laid_off",
"gender", "identity_lgbtq", "identity_bipoc", "income", "own_rent"),
label = list(gad_total ~ "GAD Score",
money_fetting_by ~ "I am just getting by financially",
employment_impact_laid_off ~ "Laid off temporarily or permanently during COVID-19 Pandemic",
phq_total ~ "PHQ Score",
occupation ~ "Occupation",
age_groups ~ "Age",
gender ~ "Gender",
identity_lgbtq ~ "Sexual or gender minority (e.g., LGBTQ2+)",
identity_bipoc ~ "Person of colour (e.g., Black, Indigenous, Asian  or other racialized minority)",
income ~ "Income",
own_rent ~ "Dwelling Ownership"),
missing = "no",
type = list(identity_lgbtq ~ "categorical",
identity_bipoc ~ "categorical",
occupation ~ "categorical",
age_groups ~ "categorical",
income ~ "categorical",
own_rent ~ "categorical",
gender ~ "categorical"))
summary_table_2 <- tbl_summary(analysis_data, include = c("gad_total", "phq_total", "occupation",
"money_fetting_by", "age_groups", "employment_impact_laid_off",
"gender", "identity_lgbtq", "identity_bipoc", "income", "own_rent"),
by = employment_impact_laid_off,
label = list(gad_total ~ "GAD Score",
money_fetting_by ~ "I am just getting by financially",
phq_total ~ "PHQ Score",
occupation ~ "Occupation",
age_groups ~ "Age",
gender ~ "Gender",
identity_lgbtq ~ "Sexual or gender minority (e.g., LGBTQ2+)",
identity_bipoc ~ "Person of colour (e.g., Black, Indigenous, Asian  or other racialized minority)",
income ~ "Income",
own_rent ~ "Dwelling Ownership"),
missing = "no",
type = list(identity_lgbtq ~ "categorical",
identity_bipoc ~ "categorical",
occupation ~ "categorical",
age_groups ~ "categorical",
income ~ "categorical",
own_rent ~ "categorical",
gender ~ "categorical")) #%>%
#as_gt %>%
#gt::gtsave(filename = "//Users//aidanbodner//Desktop//Summary.docx")
summary_table <- tbl_merge(tbls = list(summary_table_1,
summary_table_2)) %>%
as_gt %>%
gt::gtsave(file = "//Users//aidanbodner//Desktop//summary_table.docx")
