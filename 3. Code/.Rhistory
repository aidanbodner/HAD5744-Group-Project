analysis_data <- mutate_at(.tbl = analysis_data,
.vars = vars(own_rent),
.funs = ~case_when(. == "Own it with mortgage or loan (including condos)" ~ "Cost Incurred from Housing",
. == "Rent it without subsidies, i.e. you pay a market rate" ~ "Cost Incurred from Housing",
. == "Part own and part rent (shared ownership such as co-op)" ~ "Cost Incurred from Housing, Subsidized",
. == "Rent it with subsidies, i.e. you pay a below-market rate (including rent geared to income, social housing, government assisted housing, housing allowances, etc.)" ~ "Cost Incurred from Housing, Subsidized",
. == "Own it outright (including condos)" ~ "No Cost Incurred from Housing",
. == "Rent at no costs, i.e. rent-free in relative\x92s/friend\x92s property\\" ~ "No Cost Incurred from Housing",
TRUE ~ .,
TRUE ~ as.character(NA_character_)))
# Laid off during COVID
analysis_data$employment_impact_laid_off[analysis_data$employment_impact_laid_off == "8888: Not Selected"] <- "No"
analysis_data$employment_impact_laid_off[analysis_data$employment_impact_laid_off == "I was laid off temporarily or permanently"] <- "Yes"
# Sexual minority
analysis_data$identity_lgbtq[analysis_data$identity_lgbtq == "8888: Not Selected"] <- "No"
analysis_data$identity_lgbtq[analysis_data$identity_lgbtq == "Sexual or gender minorities (e.g., LGBTQ2+)"] <- "Yes"
# People of Colour
analysis_data$identity_bipoc[analysis_data$identity_bipoc == "8888: Not Selected"] <- "No"
analysis_data$identity_bipoc[analysis_data$identity_bipoc == "People of colour (e.g., Black, Indigenous, Asian  or other racialized minority)"] <- "Yes"
analysis_data <- analysis_data[, c("gad_total", "phq_total", "occupation","employment_impact_laid_off", "age_groups", "gender", "identity_lgbtq", "identity_bipoc","income", "own_rent", "money_fetting_by")]
# Number of missing
#analysis_data <- na.omit(analysis_data)
?ggplot
check_data <- raw_data[c("money_concerned"), ]
View(check_data)
check_data <- raw_data[, c("money_concerned")]
check_data <- raw_data[, c("money_concerned")]
check_data <- analysis_data[, c("gad_total", "phq_total", "money_fetting_by")]
check_data <- raw_data[, c("money_concerned")]
check_data <- analysis_data[, c("gad_total", "phq_total", "money_fetting_by")]
check_data_1 <- raw_data[, c("money_concerned")]
check_data <- rbind(check_data, check_data_1)
here() # Set working directory
raw_data <- read.csv("/Users/aidanbodner/Documents/GitHub/HAD5744-Group-Project/1. Data/data.csv",
na.strings = c(" ", "", "NA", "9999: Missing")) # Load original data
analysis_data <- raw_data[, c("gad_anxious", "gad_worry", "phq_little_interest",
"phq_feeling_down", "occupation","employment_impact_not_employed",
"money_fetting_by","employment_impact_laid_off", "age_groups", "gender",
"identity_lgbtq", "identity_bipoc",
"educational_attainment", "income",
"own_rent", "money_concerned")]
# Scan through analysis dataframe to see variable class types
for(values in names(analysis_data)){
print(names(analysis_data[values]))
name <- names(analysis_data[values])
print(class(analysis_data[,values]))
} # all variables are characters
# Remove people who were not working before the COVID-19 pandemic
analysis_data <- analysis_data[analysis_data$employment_impact_not_employed != "I was not employed or self-employed before the COVID-19", ]
# Remove people over 70
analysis_data <- analysis_data[analysis_data$age_groups != "70 to 74 years", ]
analysis_data <- analysis_data[analysis_data$age_groups != "75 to 79 years", ]
analysis_data <- analysis_data[analysis_data$age_groups != "80 to 84 years", ]
# Remove people who responded other to dwelling ownership
analysis_data <- analysis_data[analysis_data$own_rent != "Other", ]
##### Clean Labels ####
# GAD -- Over the past two weeks, how often have you felt nervous, anxious or on edge?
analysis_data$gad_anxious[analysis_data$gad_anxious == "Not at all"] <- 0
analysis_data$gad_anxious[analysis_data$gad_anxious == "Several days"] <- 1
analysis_data$gad_anxious[analysis_data$gad_anxious == "More than half the days"] <- 2
analysis_data$gad_anxious[analysis_data$gad_anxious == "Nearly every day"] <- 3
analysis_data$gad_anxious <- as.numeric(analysis_data$gad_anxious)
# GAD -- Over the past two weeks, how often were you not able to stop worrying or control your worries?
analysis_data$gad_worry[analysis_data$gad_worry == "Not at all"] <- 0
analysis_data$gad_worry[analysis_data$gad_worry == "Several days"] <- 1
analysis_data$gad_worry[analysis_data$gad_worry == "More than half the days"] <- 2
analysis_data$gad_worry[analysis_data$gad_worry == "Nearly every day"] <- 3
analysis_data$gad_worry <- as.numeric(analysis_data$gad_worry)
# Create new combined GAD score
analysis_data$gad_total <- analysis_data$gad_anxious + analysis_data$gad_worry
# PHQ -- Over the past two weeks, how often have you had little interest or pleasure in doing things?
analysis_data$phq_feeling_down[analysis_data$phq_feeling_down == "Not at all"] <- 0
analysis_data$phq_feeling_down[analysis_data$phq_feeling_down == "Several days"] <- 1
analysis_data$phq_feeling_down[analysis_data$phq_feeling_down == "More than half the days"] <- 2
analysis_data$phq_feeling_down[analysis_data$phq_feeling_down == "Nearly every day"] <- 3
analysis_data$phq_feeling_down <- as.numeric(analysis_data$phq_feeling_down)
# PHQ -- Over the PAST TWO WEEKS, how often were you feeling down, depressed or hopeless?
analysis_data$phq_little_interest[analysis_data$phq_little_interest == "Not at all"] <- 0
analysis_data$phq_little_interest[analysis_data$phq_little_interest == "Several days"] <- 1
analysis_data$phq_little_interest[analysis_data$phq_little_interest == "More than half the days"] <- 2
analysis_data$phq_little_interest[analysis_data$phq_little_interest == "Nearly every day"] <- 3
analysis_data$phq_little_interest <- as.numeric(analysis_data$phq_little_interest)
# Create new combined PHQ score
analysis_data$phq_total <- analysis_data$phq_feeling_down + analysis_data$phq_little_interest
# Occupation
analysis_data$occupation[analysis_data$occupation == "Business, finance and administration occupations"] <- "Business & Management"
analysis_data$occupation[analysis_data$occupation == "Management occupations"] <- "Business & Management"
analysis_data$occupation[analysis_data$occupation == "Natural resources, agriculture and related production occupations" ] <- "Trades"
analysis_data$occupation[analysis_data$occupation ==
"Occupations in manufacturing and utilities"] <- "Trades"
analysis_data$occupation[analysis_data$occupation == "Trades, transport and equipment operators and related occupations" ] <- "Trades"
analysis_data$occupation[analysis_data$occupation == "Health occupations" ] <- "Health & Sciences"
analysis_data$occupation[analysis_data$occupation ==
"Natural and applied sciences and related occupationss"] <- "Health & Sciences"
# How well do each of the statements describe you? - I am just getting by financially.
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Completely"] <- "Yes"
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Very Well"] <- "Yes"
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Somewhat"] <- "Yes"
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Not at all"] <- "No"
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Very Little"] <- "No"
# Age
analysis_data$age_groups[analysis_data$age_groups == "16 to 19 years"
] <- "16 to 24 years"
analysis_data$age_groups[analysis_data$age_groups ==
"20 to 24 years"] <- "16 to 24 years"
analysis_data$age_groups[analysis_data$age_groups == "25 to 29 years" ] <- "25 to 39 years"
analysis_data$age_groups[analysis_data$age_groups == "30 to 34 years"] <- "25 to 39 years"
analysis_data$age_groups[analysis_data$age_groups ==
"35 to 39 years"] <- "25 to 39 years"
analysis_data$age_groups[analysis_data$age_groups == "40 to 44 years" ] <- "40 to 54 years"
analysis_data$age_groups[analysis_data$age_groups ==
"45 to 49 years"] <- "40 to 54 years"
analysis_data$age_groups[analysis_data$age_groups ==
"50 to 54 years"] <- "40 to 54 years"
analysis_data$age_groups[analysis_data$age_groups == "55 to 59 years" ] <- "55 to 69 years"
analysis_data$age_groups[analysis_data$age_groups ==
"60 to 64 years"
] <- "55 to 69 years"
analysis_data$age_groups[analysis_data$age_groups ==
"65 to 69 years"] <- "55 to 69 years"
# Educational attainment -- TO BE COMPLETED
# Income
analysis_data$income[analysis_data$income == "Under $5,000" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$5,000 to $9,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$10,000 to $14,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$15,000 to $19,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$20,000 to $24,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$25,000 to $29,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$30,000 to $34,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$35,000 to $39,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$40,000 to $44,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$45,000 to $49,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$50,000 to $59,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$60,000 to $69,999" ] <- "Middle-Income"
analysis_data$income[analysis_data$income == "$70,000 to $79,999" ] <- "Middle-Income"
analysis_data$income[analysis_data$income == "$80,000 to $89,999" ] <- "Middle-Income"
analysis_data$income[analysis_data$income == "$90,000 to $99,999" ] <- "Middle-Income"
analysis_data$income[analysis_data$income == "$100,000 to $149,999" ] <- "High-Income"
analysis_data$income[analysis_data$income == "$150,000 to $199,999" ] <- "High-Income"
analysis_data$income[analysis_data$income == "$200,000 or more" ] <- "High-Income"
# Dwelling Ownership
analysis_data <- mutate_at(.tbl = analysis_data,
.vars = vars(own_rent),
.funs = ~case_when(. == "Own it with mortgage or loan (including condos)" ~ "Cost Incurred from Housing",
. == "Rent it without subsidies, i.e. you pay a market rate" ~ "Cost Incurred from Housing",
. == "Part own and part rent (shared ownership such as co-op)" ~ "Cost Incurred from Housing, Subsidized",
. == "Rent it with subsidies, i.e. you pay a below-market rate (including rent geared to income, social housing, government assisted housing, housing allowances, etc.)" ~ "Cost Incurred from Housing, Subsidized",
. == "Own it outright (including condos)" ~ "No Cost Incurred from Housing",
. == "Rent at no costs, i.e. rent-free in relative\x92s/friend\x92s property\\" ~ "No Cost Incurred from Housing",
TRUE ~ .,
TRUE ~ as.character(NA_character_)))
# Laid off during COVID
analysis_data$employment_impact_laid_off[analysis_data$employment_impact_laid_off == "8888: Not Selected"] <- "No"
analysis_data$employment_impact_laid_off[analysis_data$employment_impact_laid_off == "I was laid off temporarily or permanently"] <- "Yes"
# Sexual minority
analysis_data$identity_lgbtq[analysis_data$identity_lgbtq == "8888: Not Selected"] <- "No"
analysis_data$identity_lgbtq[analysis_data$identity_lgbtq == "Sexual or gender minorities (e.g., LGBTQ2+)"] <- "Yes"
# People of Colour
analysis_data$identity_bipoc[analysis_data$identity_bipoc == "8888: Not Selected"] <- "No"
analysis_data$identity_bipoc[analysis_data$identity_bipoc == "People of colour (e.g., Black, Indigenous, Asian  or other racialized minority)"] <- "Yes"
analysis_data <- analysis_data[, c("gad_total", "phq_total", "occupation","employment_impact_laid_off", "age_groups", "gender", "identity_lgbtq", "identity_bipoc","income", "own_rent", "money_fetting_by", "money_concerned")]
# Number of missing
#analysis_data <- na.omit(analysis_data)
txt_gad_plot <- ggplot(analysis_data, aes(x = money_fetting_by, y = gad_total))
txt_gad_plot
here() # Set working directory
raw_data <- read.csv("/Users/aidanbodner/Documents/GitHub/HAD5744-Group-Project/1. Data/data.csv",
na.strings = c(" ", "", "NA", "9999: Missing")) # Load original data
analysis_data <- raw_data[, c("gad_anxious", "gad_worry", "phq_little_interest",
"phq_feeling_down", "occupation","employment_impact_not_employed",
"money_fetting_by","employment_impact_laid_off", "age_groups", "gender",
"identity_lgbtq", "identity_bipoc",
"educational_attainment", "income",
"own_rent", "money_concerned")]
# Scan through analysis dataframe to see variable class types
for(values in names(analysis_data)){
print(names(analysis_data[values]))
name <- names(analysis_data[values])
print(class(analysis_data[,values]))
} # all variables are characters
# Remove people who were not working before the COVID-19 pandemic
analysis_data <- analysis_data[analysis_data$employment_impact_not_employed != "I was not employed or self-employed before the COVID-19", ]
# Remove people over 70
analysis_data <- analysis_data[analysis_data$age_groups != "70 to 74 years", ]
analysis_data <- analysis_data[analysis_data$age_groups != "75 to 79 years", ]
analysis_data <- analysis_data[analysis_data$age_groups != "80 to 84 years", ]
# Remove people who responded other to dwelling ownership
analysis_data <- analysis_data[analysis_data$own_rent != "Other", ]
##### Clean Labels ####
# GAD -- Over the past two weeks, how often have you felt nervous, anxious or on edge?
analysis_data$gad_anxious[analysis_data$gad_anxious == "Not at all"] <- 0
analysis_data$gad_anxious[analysis_data$gad_anxious == "Several days"] <- 1
analysis_data$gad_anxious[analysis_data$gad_anxious == "More than half the days"] <- 2
analysis_data$gad_anxious[analysis_data$gad_anxious == "Nearly every day"] <- 3
analysis_data$gad_anxious <- as.numeric(analysis_data$gad_anxious)
# GAD -- Over the past two weeks, how often were you not able to stop worrying or control your worries?
analysis_data$gad_worry[analysis_data$gad_worry == "Not at all"] <- 0
analysis_data$gad_worry[analysis_data$gad_worry == "Several days"] <- 1
analysis_data$gad_worry[analysis_data$gad_worry == "More than half the days"] <- 2
analysis_data$gad_worry[analysis_data$gad_worry == "Nearly every day"] <- 3
analysis_data$gad_worry <- as.numeric(analysis_data$gad_worry)
# Create new combined GAD score
analysis_data$gad_total <- analysis_data$gad_anxious + analysis_data$gad_worry
# PHQ -- Over the past two weeks, how often have you had little interest or pleasure in doing things?
analysis_data$phq_feeling_down[analysis_data$phq_feeling_down == "Not at all"] <- 0
analysis_data$phq_feeling_down[analysis_data$phq_feeling_down == "Several days"] <- 1
analysis_data$phq_feeling_down[analysis_data$phq_feeling_down == "More than half the days"] <- 2
analysis_data$phq_feeling_down[analysis_data$phq_feeling_down == "Nearly every day"] <- 3
analysis_data$phq_feeling_down <- as.numeric(analysis_data$phq_feeling_down)
# PHQ -- Over the PAST TWO WEEKS, how often were you feeling down, depressed or hopeless?
analysis_data$phq_little_interest[analysis_data$phq_little_interest == "Not at all"] <- 0
analysis_data$phq_little_interest[analysis_data$phq_little_interest == "Several days"] <- 1
analysis_data$phq_little_interest[analysis_data$phq_little_interest == "More than half the days"] <- 2
analysis_data$phq_little_interest[analysis_data$phq_little_interest == "Nearly every day"] <- 3
analysis_data$phq_little_interest <- as.numeric(analysis_data$phq_little_interest)
# Create new combined PHQ score
analysis_data$phq_total <- analysis_data$phq_feeling_down + analysis_data$phq_little_interest
# Occupation
analysis_data$occupation[analysis_data$occupation == "Business, finance and administration occupations"] <- "Business & Management"
analysis_data$occupation[analysis_data$occupation == "Management occupations"] <- "Business & Management"
analysis_data$occupation[analysis_data$occupation == "Natural resources, agriculture and related production occupations" ] <- "Trades"
analysis_data$occupation[analysis_data$occupation ==
"Occupations in manufacturing and utilities"] <- "Trades"
analysis_data$occupation[analysis_data$occupation == "Trades, transport and equipment operators and related occupations" ] <- "Trades"
analysis_data$occupation[analysis_data$occupation == "Health occupations" ] <- "Health & Sciences"
analysis_data$occupation[analysis_data$occupation ==
"Natural and applied sciences and related occupationss"] <- "Health & Sciences"
# How well do each of the statements describe you? - I am just getting by financially.
#analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Completely"] <- "Yes"
#analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Very Well"] <- "Yes"
#analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Somewhat"] <- "Yes"
#analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Not at all"] <- "No"
#analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Very Little"] <- "No"
# Age
analysis_data$age_groups[analysis_data$age_groups == "16 to 19 years"
] <- "16 to 24 years"
analysis_data$age_groups[analysis_data$age_groups ==
"20 to 24 years"] <- "16 to 24 years"
analysis_data$age_groups[analysis_data$age_groups == "25 to 29 years" ] <- "25 to 39 years"
analysis_data$age_groups[analysis_data$age_groups == "30 to 34 years"] <- "25 to 39 years"
analysis_data$age_groups[analysis_data$age_groups ==
"35 to 39 years"] <- "25 to 39 years"
analysis_data$age_groups[analysis_data$age_groups == "40 to 44 years" ] <- "40 to 54 years"
analysis_data$age_groups[analysis_data$age_groups ==
"45 to 49 years"] <- "40 to 54 years"
analysis_data$age_groups[analysis_data$age_groups ==
"50 to 54 years"] <- "40 to 54 years"
analysis_data$age_groups[analysis_data$age_groups == "55 to 59 years" ] <- "55 to 69 years"
analysis_data$age_groups[analysis_data$age_groups ==
"60 to 64 years"
] <- "55 to 69 years"
analysis_data$age_groups[analysis_data$age_groups ==
"65 to 69 years"] <- "55 to 69 years"
# Educational attainment -- TO BE COMPLETED
# Income
analysis_data$income[analysis_data$income == "Under $5,000" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$5,000 to $9,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$10,000 to $14,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$15,000 to $19,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$20,000 to $24,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$25,000 to $29,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$30,000 to $34,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$35,000 to $39,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$40,000 to $44,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$45,000 to $49,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$50,000 to $59,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$60,000 to $69,999" ] <- "Middle-Income"
analysis_data$income[analysis_data$income == "$70,000 to $79,999" ] <- "Middle-Income"
analysis_data$income[analysis_data$income == "$80,000 to $89,999" ] <- "Middle-Income"
analysis_data$income[analysis_data$income == "$90,000 to $99,999" ] <- "Middle-Income"
analysis_data$income[analysis_data$income == "$100,000 to $149,999" ] <- "High-Income"
analysis_data$income[analysis_data$income == "$150,000 to $199,999" ] <- "High-Income"
analysis_data$income[analysis_data$income == "$200,000 or more" ] <- "High-Income"
# Dwelling Ownership
analysis_data <- mutate_at(.tbl = analysis_data,
.vars = vars(own_rent),
.funs = ~case_when(. == "Own it with mortgage or loan (including condos)" ~ "Cost Incurred from Housing",
. == "Rent it without subsidies, i.e. you pay a market rate" ~ "Cost Incurred from Housing",
. == "Part own and part rent (shared ownership such as co-op)" ~ "Cost Incurred from Housing, Subsidized",
. == "Rent it with subsidies, i.e. you pay a below-market rate (including rent geared to income, social housing, government assisted housing, housing allowances, etc.)" ~ "Cost Incurred from Housing, Subsidized",
. == "Own it outright (including condos)" ~ "No Cost Incurred from Housing",
. == "Rent at no costs, i.e. rent-free in relative\x92s/friend\x92s property\\" ~ "No Cost Incurred from Housing",
TRUE ~ .,
TRUE ~ as.character(NA_character_)))
# Laid off during COVID
analysis_data$employment_impact_laid_off[analysis_data$employment_impact_laid_off == "8888: Not Selected"] <- "No"
analysis_data$employment_impact_laid_off[analysis_data$employment_impact_laid_off == "I was laid off temporarily or permanently"] <- "Yes"
# Sexual minority
analysis_data$identity_lgbtq[analysis_data$identity_lgbtq == "8888: Not Selected"] <- "No"
analysis_data$identity_lgbtq[analysis_data$identity_lgbtq == "Sexual or gender minorities (e.g., LGBTQ2+)"] <- "Yes"
# People of Colour
analysis_data$identity_bipoc[analysis_data$identity_bipoc == "8888: Not Selected"] <- "No"
analysis_data$identity_bipoc[analysis_data$identity_bipoc == "People of colour (e.g., Black, Indigenous, Asian  or other racialized minority)"] <- "Yes"
analysis_data <- analysis_data[, c("gad_total", "phq_total", "occupation","employment_impact_laid_off", "age_groups", "gender", "identity_lgbtq", "identity_bipoc","income", "own_rent", "money_fetting_by", "money_concerned")]
# Number of missing
#analysis_data <- na.omit(analysis_data)
ggplot(analysis_data, aes(x = money_fetting_by, y = gad_total))
plot(analysis_data$money_fetting_by, analysis_data$gad_total)
analysis_data$money_fetting_by <- as.factor(analysis_data$money_fetting_by)
plot(analysis_data$money_fetting_by, analysis_data$gad_total)
ggplot(analysis_data, aes(x = money_fetting_by, y = gad_total))
ggplot(analysis_data, aes(x = money_fetting_by, y = gad_total)) + geom_point()
ggplot(analysis_data, aes(gad_total,group=money_fetting_by,fill=money_fetting_by)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic()
ggplot(analysis_data, aes(gad_total,group=money_fetting_by,)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_classic()
ggplot(analysis_data, aes(gad_total,group=money_fetting_by,)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_minimal()
ggplot(analysis_data, aes(x = money_fetting_by, y = gad_total, group=money_fetting_by)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_minimal()
ggplot(analysis_data, aes(x = money_fetting_by, y = gad_total)) +
geom_histogram(binwidth = 1,alpha = 0.75) + theme_minimal()
ggplot(analysis_data, aes(x = money_fetting_by, y = gad_total)) +
geom_bar(binwidth = 1,alpha = 0.75) + theme_minimal()
ggplot(analysis_data, aes(x = money_fetting_by, y = gad_total)) +
geom_bar(stat = "identity") + theme_minimal()
txt_phq_plot <- ggplot(analysis_data, aes(x = money_fetting_by, y = money_concerned))
txt_phq_plot
txt_phq_plot <- ggplot(analysis_data, aes(x = money_fetting_by, y = money_concerned)) + geom_point()
txt_phq_plot
ggplot(analysis_data, aes(x = money_fetting_by, y = money_concerned)) + geom_bar()
ggplot(analysis_data, x = money_fetting_by, y = money_concerned) + geom_bar()
ggplot(analysis_data, x = money_fetting_by, y = money_concerned) + geom_bar(stat = "identity")
ggplot(analysis_data, aes(x = money_fetting_by, y = money_concerned)) + geom_bar(stat = "identity")
cor(analysis_data$money_fetting_by, analysis_data$money_concerned)
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Completely"] <- 5
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Very Well"] <- 4
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Somewhat"] <- 3
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Not at all"] <- 2
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Very Little"] <- 1
analysis_data$money_concerned[analysis_data$money_concerned == "Completely"] <- 5
analysis_data$money_concerned[analysis_data$money_concerned == "Very Well"] <- 4
analysis_data$money_concerned[analysis_data$money_concerned == "Somewhat"] <- 3
analysis_data$money_concerned[analysis_data$money_concerned == "Not at all"] <- 2
analysis_data$money_concerned[analysis_data$money_concerned == "Very Little"] <- 1
cor(analysis_data$money_fetting_by, analysis_data$money_concerned)
class(analysis_data$money_concerned)
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Completely"] <- 5
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Very Well"] <- 4
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Somewhat"] <- 3
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Not at all"] <- 2
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Very Little"] <- 1
analysis_data$money_concerned[analysis_data$money_concerned == "Completely"] <- 5
analysis_data$money_concerned[analysis_data$money_concerned == "Very Well"] <- 4
analysis_data$money_concerned[analysis_data$money_concerned == "Somewhat"] <- 3
analysis_data$money_concerned[analysis_data$money_concerned == "Not at all"] <- 2
analysis_data$money_concerned[analysis_data$money_concerned == "Very Little"] <- 1
class(analysis_data$money_concerned)
View(analysis_data)
here() # Set working directory
raw_data <- read.csv("/Users/aidanbodner/Documents/GitHub/HAD5744-Group-Project/1. Data/data.csv",
na.strings = c(" ", "", "NA", "9999: Missing")) # Load original data
analysis_data <- raw_data[, c("gad_anxious", "gad_worry", "phq_little_interest",
"phq_feeling_down", "occupation","employment_impact_not_employed",
"money_fetting_by","employment_impact_laid_off", "age_groups", "gender",
"identity_lgbtq", "identity_bipoc",
"educational_attainment", "income",
"own_rent", "money_concerned")]
# Scan through analysis dataframe to see variable class types
for(values in names(analysis_data)){
print(names(analysis_data[values]))
name <- names(analysis_data[values])
print(class(analysis_data[,values]))
} # all variables are characters
# Remove people who were not working before the COVID-19 pandemic
analysis_data <- analysis_data[analysis_data$employment_impact_not_employed != "I was not employed or self-employed before the COVID-19", ]
# Remove people over 70
analysis_data <- analysis_data[analysis_data$age_groups != "70 to 74 years", ]
analysis_data <- analysis_data[analysis_data$age_groups != "75 to 79 years", ]
analysis_data <- analysis_data[analysis_data$age_groups != "80 to 84 years", ]
# Remove people who responded other to dwelling ownership
analysis_data <- analysis_data[analysis_data$own_rent != "Other", ]
##### Clean Labels ####
# GAD -- Over the past two weeks, how often have you felt nervous, anxious or on edge?
analysis_data$gad_anxious[analysis_data$gad_anxious == "Not at all"] <- 0
analysis_data$gad_anxious[analysis_data$gad_anxious == "Several days"] <- 1
analysis_data$gad_anxious[analysis_data$gad_anxious == "More than half the days"] <- 2
analysis_data$gad_anxious[analysis_data$gad_anxious == "Nearly every day"] <- 3
analysis_data$gad_anxious <- as.numeric(analysis_data$gad_anxious)
# GAD -- Over the past two weeks, how often were you not able to stop worrying or control your worries?
analysis_data$gad_worry[analysis_data$gad_worry == "Not at all"] <- 0
analysis_data$gad_worry[analysis_data$gad_worry == "Several days"] <- 1
analysis_data$gad_worry[analysis_data$gad_worry == "More than half the days"] <- 2
analysis_data$gad_worry[analysis_data$gad_worry == "Nearly every day"] <- 3
analysis_data$gad_worry <- as.numeric(analysis_data$gad_worry)
# Create new combined GAD score
analysis_data$gad_total <- analysis_data$gad_anxious + analysis_data$gad_worry
# PHQ -- Over the past two weeks, how often have you had little interest or pleasure in doing things?
analysis_data$phq_feeling_down[analysis_data$phq_feeling_down == "Not at all"] <- 0
analysis_data$phq_feeling_down[analysis_data$phq_feeling_down == "Several days"] <- 1
analysis_data$phq_feeling_down[analysis_data$phq_feeling_down == "More than half the days"] <- 2
analysis_data$phq_feeling_down[analysis_data$phq_feeling_down == "Nearly every day"] <- 3
analysis_data$phq_feeling_down <- as.numeric(analysis_data$phq_feeling_down)
# PHQ -- Over the PAST TWO WEEKS, how often were you feeling down, depressed or hopeless?
analysis_data$phq_little_interest[analysis_data$phq_little_interest == "Not at all"] <- 0
analysis_data$phq_little_interest[analysis_data$phq_little_interest == "Several days"] <- 1
analysis_data$phq_little_interest[analysis_data$phq_little_interest == "More than half the days"] <- 2
analysis_data$phq_little_interest[analysis_data$phq_little_interest == "Nearly every day"] <- 3
analysis_data$phq_little_interest <- as.numeric(analysis_data$phq_little_interest)
# Create new combined PHQ score
analysis_data$phq_total <- analysis_data$phq_feeling_down + analysis_data$phq_little_interest
# Occupation
analysis_data$occupation[analysis_data$occupation == "Business, finance and administration occupations"] <- "Business & Management"
analysis_data$occupation[analysis_data$occupation == "Management occupations"] <- "Business & Management"
analysis_data$occupation[analysis_data$occupation == "Natural resources, agriculture and related production occupations" ] <- "Trades"
analysis_data$occupation[analysis_data$occupation ==
"Occupations in manufacturing and utilities"] <- "Trades"
analysis_data$occupation[analysis_data$occupation == "Trades, transport and equipment operators and related occupations" ] <- "Trades"
analysis_data$occupation[analysis_data$occupation == "Health occupations" ] <- "Health & Sciences"
analysis_data$occupation[analysis_data$occupation ==
"Natural and applied sciences and related occupationss"] <- "Health & Sciences"
# How well do each of the statements describe you? - I am just getting by financially.
#analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Completely"] <- "Yes"
#analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Very Well"] <- "Yes"
#analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Somewhat"] <- "Yes"
#analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Not at all"] <- "No"
#analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Very Little"] <- "No"
# Age
analysis_data$age_groups[analysis_data$age_groups == "16 to 19 years"
] <- "16 to 24 years"
analysis_data$age_groups[analysis_data$age_groups ==
"20 to 24 years"] <- "16 to 24 years"
analysis_data$age_groups[analysis_data$age_groups == "25 to 29 years" ] <- "25 to 39 years"
analysis_data$age_groups[analysis_data$age_groups == "30 to 34 years"] <- "25 to 39 years"
analysis_data$age_groups[analysis_data$age_groups ==
"35 to 39 years"] <- "25 to 39 years"
analysis_data$age_groups[analysis_data$age_groups == "40 to 44 years" ] <- "40 to 54 years"
analysis_data$age_groups[analysis_data$age_groups ==
"45 to 49 years"] <- "40 to 54 years"
analysis_data$age_groups[analysis_data$age_groups ==
"50 to 54 years"] <- "40 to 54 years"
analysis_data$age_groups[analysis_data$age_groups == "55 to 59 years" ] <- "55 to 69 years"
analysis_data$age_groups[analysis_data$age_groups ==
"60 to 64 years"
] <- "55 to 69 years"
analysis_data$age_groups[analysis_data$age_groups ==
"65 to 69 years"] <- "55 to 69 years"
# Educational attainment -- TO BE COMPLETED
# Income
analysis_data$income[analysis_data$income == "Under $5,000" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$5,000 to $9,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$10,000 to $14,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$15,000 to $19,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$20,000 to $24,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$25,000 to $29,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$30,000 to $34,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$35,000 to $39,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$40,000 to $44,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$45,000 to $49,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$50,000 to $59,999" ] <- "Low-Income"
analysis_data$income[analysis_data$income == "$60,000 to $69,999" ] <- "Middle-Income"
analysis_data$income[analysis_data$income == "$70,000 to $79,999" ] <- "Middle-Income"
analysis_data$income[analysis_data$income == "$80,000 to $89,999" ] <- "Middle-Income"
analysis_data$income[analysis_data$income == "$90,000 to $99,999" ] <- "Middle-Income"
analysis_data$income[analysis_data$income == "$100,000 to $149,999" ] <- "High-Income"
analysis_data$income[analysis_data$income == "$150,000 to $199,999" ] <- "High-Income"
analysis_data$income[analysis_data$income == "$200,000 or more" ] <- "High-Income"
# Dwelling Ownership
analysis_data <- mutate_at(.tbl = analysis_data,
.vars = vars(own_rent),
.funs = ~case_when(. == "Own it with mortgage or loan (including condos)" ~ "Cost Incurred from Housing",
. == "Rent it without subsidies, i.e. you pay a market rate" ~ "Cost Incurred from Housing",
. == "Part own and part rent (shared ownership such as co-op)" ~ "Cost Incurred from Housing, Subsidized",
. == "Rent it with subsidies, i.e. you pay a below-market rate (including rent geared to income, social housing, government assisted housing, housing allowances, etc.)" ~ "Cost Incurred from Housing, Subsidized",
. == "Own it outright (including condos)" ~ "No Cost Incurred from Housing",
. == "Rent at no costs, i.e. rent-free in relative\x92s/friend\x92s property\\" ~ "No Cost Incurred from Housing",
TRUE ~ .,
TRUE ~ as.character(NA_character_)))
# Laid off during COVID
analysis_data$employment_impact_laid_off[analysis_data$employment_impact_laid_off == "8888: Not Selected"] <- "No"
analysis_data$employment_impact_laid_off[analysis_data$employment_impact_laid_off == "I was laid off temporarily or permanently"] <- "Yes"
# Sexual minority
analysis_data$identity_lgbtq[analysis_data$identity_lgbtq == "8888: Not Selected"] <- "No"
analysis_data$identity_lgbtq[analysis_data$identity_lgbtq == "Sexual or gender minorities (e.g., LGBTQ2+)"] <- "Yes"
# People of Colour
analysis_data$identity_bipoc[analysis_data$identity_bipoc == "8888: Not Selected"] <- "No"
analysis_data$identity_bipoc[analysis_data$identity_bipoc == "People of colour (e.g., Black, Indigenous, Asian  or other racialized minority)"] <- "Yes"
analysis_data <- analysis_data[, c("gad_total", "phq_total", "occupation","employment_impact_laid_off", "age_groups", "gender", "identity_lgbtq", "identity_bipoc","income", "own_rent", "money_fetting_by", "money_concerned")]
# Number of missing
#analysis_data <- na.omit(analysis_data)
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Completely"] <- 5
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Very Well"] <- 4
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Somewhat"] <- 3
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Not at all"] <- 2
analysis_data$money_fetting_by[analysis_data$money_fetting_by == "Very Little"] <- 1
analysis_data$money_concerned[analysis_data$money_concerned == "Completely"] <- 5
analysis_data$money_concerned[analysis_data$money_concerned == "Very Well"] <- 4
analysis_data$money_concerned[analysis_data$money_concerned == "Somewhat"] <- 3
analysis_data$money_concerned[analysis_data$money_concerned == "Not at all"] <- 2
analysis_data$money_concerned[analysis_data$money_concerned == "Very Little"] <- 1
cor(analysis_data$money_fetting_by, analysis_data$money_concerned)
class(analysis_data$money_concerned)
View(analysis_data)
ggplot(analysis_data, aes(x = money_fetting_by, y = money_concerned)) + geom_bar(stat = "identity")
analysis_data$money_concerned <- as.numeric(analysis_data$money_concerned)
analysis_data$money_concerned <- as.numeric(analysis_data$money_concerned)
class(analysis_data$money_concerned)
analysis_data$money_fetting_by <- as.numeric(analysis_data$money_fetting_by)
cor(analysis_data$money_fetting_by, analysis_data$money_concerned)
View(analysis_data)
?cor
cor(x = analysis_data$money_fetting_by, y = analysis_data$money_concerned)
ggplot(analysis_data, aes(x = money_fetting_by, y = money_concerned)) + geom_bar(stat = "identity")
cor(x = analysis_data$money_fetting_by, y = analysis_data$money_concerned)
ggplot(analysis_data, aes(x = money_fetting_by, y = money_concerned)) + geom_bar(stat = "identity")
plot(analysis_data$money_fetting_by, analysis_data$gad_total)
ggplot(analysis_data, aes(x = money_fetting_by, y = money_concerned)) + geom_point()
plot(x = analysis_data$money_fetting_by, y = analysis_data$money_concerned)
cor(x = analysis_data$money_fetting_by, y = analysis_data$money_concerned, use = “complete.obs”)
cor(x = analysis_data$money_fetting_by, y = analysis_data$money_concerned, na.rm = TRUE)
cor(x = analysis_data$money_fetting_by, y = analysis_data$money_concerned, na.rm = TRUE, method = "pearson")
cor(x = analysis_data$money_fetting_by, y = analysis_data$money_concerned, use = "complete.obs", method = "pearson")
